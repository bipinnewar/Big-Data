{"paragraphs":[{"text":"%spark2\r\n// Load merged data from HDFS\r\nval merged_df = spark.read.option(\"header\", \"true\").option(\"inferSchema\", \"true\")\r\n    .csv(\"hdfs://sandbox-hdp.hortonworks.com:8020/user/com745_cw2/data/outputs/deprivation_mortality_2020.csv\")\r\n\r\n// Create temporary SQL view\r\nmerged_df.createOrReplaceTempView(\"deprivation_mortality\")\r\n\r\n// Show data sample\r\nprintln(\"=== Merged Data Sample ===\")\r\nmerged_df.show(5)\r\n\r\n// Compute Pearson correlation in Spark\r\nval correlation_df = merged_df.select(corr(\"Mean_IMD_Score\", \"Avg_Mortality_Rate\").alias(\"pearson_correlation\"))\r\n\r\n// Show correlation\r\nprintln(\"=== Pearson Correlation ===\")\r\ncorrelation_df.show()","user":"anonymous","dateUpdated":"2025-08-14T21:08:05+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{"0":{"graph":{"mode":"table","height":355.556,"optionOpen":false}}},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"merged_df: org.apache.spark.sql.DataFrame = [IMD_Decile: int, Mean_IMD_Score: double ... 1 more field]\n=== Merged Data Sample ===\n+----------+--------------+------------------+\n|IMD_Decile|Mean_IMD_Score|Avg_Mortality_Rate|\n+----------+--------------+------------------+\n|         1|          55.5|            522.45|\n|         2|         38.05|             406.0|\n|         3|         29.69|             339.9|\n|         4|          23.9|            281.05|\n|         5|         19.55|            244.75|\n+----------+--------------+------------------+\nonly showing top 5 rows\n\ncorrelation_df: org.apache.spark.sql.DataFrame = [pearson_correlation: double]\n=== Pearson Correlation ===\n+-------------------+\n|pearson_correlation|\n+-------------------+\n|  0.998125196649165|\n+-------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1755204830000_603028355","id":"20250813-213422_94959496","dateCreated":"2025-08-14T20:53:50+0000","dateStarted":"2025-08-14T20:56:22+0000","dateFinished":"2025-08-14T20:59:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:158"},{"text":"%sql\r\n-- Display all data ordered by IMD_Decile for table visualization\r\nSELECT * FROM deprivation_mortality ORDER BY IMD_Decile","user":"anonymous","dateUpdated":"2025-08-14T21:08:28+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{"0":{"graph":{"mode":"table","height":365.556,"optionOpen":false}}},"enabled":true,"editorSetting":{"language":"sql"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"IMD_Decile\tMean_IMD_Score\tAvg_Mortality_Rate\n1\t55.5\t522.45\n2\t38.05\t406.0\n3\t29.69\t339.9\n4\t23.9\t281.05\n5\t19.55\t244.75\n6\t15.9\t217.65\n7\t12.74\t197.0\n8\t9.92\t183.9\n9\t7.3\t166.05\n10\t4.15\t139.0\n"}]},"apps":[],"jobName":"paragraph_1755204830040_587638399","id":"20250813-213456_1042074669","dateCreated":"2025-08-14T20:53:50+0000","dateStarted":"2025-08-14T20:59:42+0000","dateFinished":"2025-08-14T20:59:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:159"},{"text":"%sql\r\n-- Data for Scatter Plot: Mean_IMD_Score vs. Avg_Mortality_Rate\r\n-- In Zeppelin UI, set as scatter chart with X = Mean_IMD_Score, Y = Avg_Mortality_Rate, Groups = IMD_Decile\r\nSELECT Mean_IMD_Score, Avg_Mortality_Rate, IMD_Decile FROM deprivation_mortality ORDER BY IMD_Decile","user":"anonymous","dateUpdated":"2025-08-14T21:06:50+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{"0":{"graph":{"mode":"scatterChart","height":253.524,"optionOpen":false,"setting":{"scatterChart":{"xAxis":{"name":"Mean_IMD_Score","index":0,"aggr":"sum"},"yAxis":{"name":"Avg_Mortality_Rate","index":1,"aggr":"sum"},"group":{"name":"IMD_Decile","index":2,"aggr":"sum"}}}},"helium":{}}},"enabled":true,"editorSetting":{"language":"sql"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Mean_IMD_Score\tAvg_Mortality_Rate\tIMD_Decile\n55.5\t522.45\t1\n38.05\t406.0\t2\n29.69\t339.9\t3\n23.9\t281.05\t4\n19.55\t244.75\t5\n15.9\t217.65\t6\n12.74\t197.0\t7\n9.92\t183.9\t8\n7.3\t166.05\t9\n4.15\t139.0\t10\n"}]},"apps":[],"jobName":"paragraph_1755204830043_588023148","id":"20250813-214328_169771891","dateCreated":"2025-08-14T20:53:50+0000","dateStarted":"2025-08-14T20:59:52+0000","dateFinished":"2025-08-14T20:59:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:160"},{"text":"%sql\r\n-- Data for Bar Chart: Avg_Mortality_Rate by IMD_Decile\r\n-- In Zeppelin UI, set as bar chart with Keys = IMD_Decile, Values = Avg_Mortality_Rate\r\nSELECT IMD_Decile, Avg_Mortality_Rate FROM deprivation_mortality ORDER BY IMD_Decile","user":"anonymous","dateUpdated":"2025-08-14T21:00:02+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false},"helium":{}}},"enabled":true,"editorSetting":{"language":"sql"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"IMD_Decile\tAvg_Mortality_Rate\n1\t522.45\n2\t406.0\n3\t339.9\n4\t281.05\n5\t244.75\n6\t217.65\n7\t197.0\n8\t183.9\n9\t166.05\n10\t139.0\n"}]},"apps":[],"jobName":"paragraph_1755204830047_586484153","id":"20250813-214358_1216635779","dateCreated":"2025-08-14T20:53:50+0000","dateStarted":"2025-08-14T21:00:03+0000","dateFinished":"2025-08-14T21:00:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:161"},{"text":"%sql\r\n-- Data for Line Chart: Avg_Mortality_Rate trend across IMD_Decile\r\n-- In Zeppelin UI, set as line chart with X = IMD_Decile, Y = Avg_Mortality_Rate\r\nSELECT IMD_Decile, Avg_Mortality_Rate FROM deprivation_mortality ORDER BY IMD_Decile","user":"anonymous","dateUpdated":"2025-08-14T21:00:10+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{"0":{"graph":{"mode":"lineChart","height":300,"optionOpen":false,"setting":{"lineChart":{}},"commonSetting":{},"keys":[{"name":"IMD_Decile","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"Avg_Mortality_Rate","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true,"editorSetting":{"language":"sql"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"IMD_Decile\tAvg_Mortality_Rate\n1\t522.45\n2\t406.0\n3\t339.9\n4\t281.05\n5\t244.75\n6\t217.65\n7\t197.0\n8\t183.9\n9\t166.05\n10\t139.0\n"}]},"apps":[],"jobName":"paragraph_1755204830050_573017941","id":"20250813-214853_394750190","dateCreated":"2025-08-14T20:53:50+0000","dateStarted":"2025-08-14T21:00:10+0000","dateFinished":"2025-08-14T21:00:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:162"},{"text":"%sql\r\n-- Data for Pie Chart: Proportion of Mortality Rates by Deprivation Level\r\n-- Categorize into High, Medium, Low deprivation\r\n-- In Zeppelin UI, set as pie chart with Keys = Deprivation_Level, Values = Avg_Mortality_Rate\r\nSELECT \r\n    CASE \r\n        WHEN Mean_IMD_Score >= 35 THEN 'High Deprivation'\r\n        WHEN Mean_IMD_Score BETWEEN 20 AND 34.99 THEN 'Medium Deprivation'\r\n        ELSE 'Low Deprivation'\r\n    END AS Deprivation_Level,\r\n    AVG(Avg_Mortality_Rate) AS Avg_Mortality_Rate\r\nFROM deprivation_mortality\r\nGROUP BY \r\n    CASE \r\n        WHEN Mean_IMD_Score >= 35 THEN 'High Deprivation'\r\n        WHEN Mean_IMD_Score BETWEEN 20 AND 34.99 THEN 'Medium Deprivation'\r\n        ELSE 'Low Deprivation'\r\n    END\r\nORDER BY Avg_Mortality_Rate DESC","user":"anonymous","dateUpdated":"2025-08-14T21:07:04+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{"0":{"graph":{"mode":"pieChart","height":315.556,"optionOpen":false},"helium":{}}},"enabled":true,"editorSetting":{"language":"sql"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Deprivation_Level\tAvg_Mortality_Rate\nHigh Deprivation\t464.225\nMedium Deprivation\t310.475\nLow Deprivation\t191.39166666666665\n"}]},"apps":[],"jobName":"paragraph_1755204830052_570709448","id":"20250814-111417_1925961224","dateCreated":"2025-08-14T20:53:50+0000","dateStarted":"2025-08-14T21:00:19+0000","dateFinished":"2025-08-14T21:00:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:163"},{"text":"%sql\r\n-- Data for Stacked Bar Chart: Comparison of Mean_IMD_Score and Avg_Mortality_Rate by IMD_Decile\r\n-- In Zeppelin UI, set as stacked bar chart with Keys = IMD_Decile, Values = Mean_IMD_Score and Avg_Mortality_Rate\r\nSELECT IMD_Decile, Mean_IMD_Score, Avg_Mortality_Rate FROM deprivation_mortality ORDER BY IMD_Decile","user":"anonymous","dateUpdated":"2025-08-14T21:00:33+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"stacked":true}},"commonSetting":{},"keys":[{"name":"IMD_Decile","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"Mean_IMD_Score","index":1,"aggr":"sum"},{"name":"Avg_Mortality_Rate","index":2,"aggr":"sum"}]},"helium":{}}},"enabled":true,"editorSetting":{"language":"sql"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"IMD_Decile\tMean_IMD_Score\tAvg_Mortality_Rate\n1\t55.5\t522.45\n2\t38.05\t406.0\n3\t29.69\t339.9\n4\t23.9\t281.05\n5\t19.55\t244.75\n6\t15.9\t217.65\n7\t12.74\t197.0\n8\t9.92\t183.9\n9\t7.3\t166.05\n10\t4.15\t139.0\n"}]},"apps":[],"jobName":"paragraph_1755204830054_571478946","id":"20250814-111653_2101285739","dateCreated":"2025-08-14T20:53:50+0000","dateStarted":"2025-08-14T21:00:33+0000","dateFinished":"2025-08-14T21:00:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:164"},{"text":"%sql\r\n-- Data for Area Chart: Cumulative Mortality Rate across Deciles\r\n-- In Zeppelin UI, set as area chart with X = IMD_Decile, Y = Avg_Mortality_Rate\r\nSELECT IMD_Decile, SUM(Avg_Mortality_Rate) OVER (ORDER BY IMD_Decile) AS Cumulative_Mortality FROM deprivation_mortality ORDER BY IMD_Decile","user":"anonymous","dateUpdated":"2025-08-14T21:00:39+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{"0":{"graph":{"mode":"stackedAreaChart","height":300,"optionOpen":false},"helium":{}}},"enabled":true,"editorSetting":{"language":"sql"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"IMD_Decile\tCumulative_Mortality\n1\t522.45\n2\t928.45\n3\t1268.35\n4\t1549.3999999999999\n5\t1794.1499999999999\n6\t2011.8\n7\t2208.8\n8\t2392.7000000000003\n9\t2558.7500000000005\n10\t2697.7500000000005\n"}]},"apps":[],"jobName":"paragraph_1755204830056_569170452","id":"20250814-112250_703180929","dateCreated":"2025-08-14T20:53:50+0000","dateStarted":"2025-08-14T21:00:40+0000","dateFinished":"2025-08-14T21:00:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:165"},{"text":"%sql\r\n-- Data for Grouped Bar Chart: Mortality Rate and IMD Score by Deprivation Category\r\n-- In Zeppelin UI, set as grouped bar chart with Keys = Deprivation_Level, Groups = Metric, Values = Value\r\nSELECT \r\n    CASE \r\n        WHEN Mean_IMD_Score >= 35 THEN 'High Deprivation'\r\n        WHEN Mean_IMD_Score BETWEEN 20 AND 34.99 THEN 'Medium Deprivation'\r\n        ELSE 'Low Deprivation'\r\n    END AS Deprivation_Level,\r\n    'Avg_Mortality_Rate' AS Metric,\r\n    AVG(Avg_Mortality_Rate) AS Value\r\nFROM deprivation_mortality\r\nGROUP BY Deprivation_Level\r\nUNION ALL\r\nSELECT \r\n    CASE \r\n        WHEN Mean_IMD_Score >= 35 THEN 'High Deprivation'\r\n        WHEN Mean_IMD_Score BETWEEN 20 AND 34.99 THEN 'Medium Deprivation'\r\n        ELSE 'Low Deprivation'\r\n    END AS Deprivation_Level,\r\n    'Mean_IMD_Score' AS Metric,\r\n    AVG(Mean_IMD_Score) AS Value\r\nFROM deprivation_mortality\r\nGROUP BY Deprivation_Level\r\nORDER BY Deprivation_Level, Metric","user":"anonymous","dateUpdated":"2025-08-14T21:00:49+0000","config":{"colWidth":12,"editorMode":"ace/mode/sql","results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"stacked":false}},"commonSetting":{},"keys":[{"name":"Deprivation_Level","index":0,"aggr":"sum"}],"groups":[{"name":"Metric","index":1,"aggr":"sum"}],"values":[{"name":"Value","index":2,"aggr":"sum"}]},"helium":{}}},"enabled":true,"editorSetting":{"language":"sql"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Deprivation_Level\tMetric\tValue\nHigh Deprivation\tAvg_Mortality_Rate\t464.225\nHigh Deprivation\tMean_IMD_Score\t46.775\nLow Deprivation\tAvg_Mortality_Rate\t191.39166666666665\nLow Deprivation\tMean_IMD_Score\t11.593333333333335\nMedium Deprivation\tAvg_Mortality_Rate\t310.475\nMedium Deprivation\tMean_IMD_Score\t26.795\n"}]},"apps":[],"jobName":"paragraph_1755204830058_569939950","id":"20250814-112331_533051997","dateCreated":"2025-08-14T20:53:50+0000","dateStarted":"2025-08-14T21:00:51+0000","dateFinished":"2025-08-14T21:00:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:166"},{"text":"%sql\n","dateUpdated":"2025-08-14T20:53:50+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1755204830061_567246708","id":"20250814-112346_239629471","dateCreated":"2025-08-14T20:53:50+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:167"}],"name":"IMD_Deaths_Analysis_CW2 1","id":"2M2JBVWB7","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}